{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to bpfd bpfd is a system daemon for managing eBPF programs. It currently a work in progress! Why bpfd? bpfd seeks to solve the following problems: To allow multiple XDP programs to share the same interface To give administrators control over who can load programs and to allow them to define rules for ordering of networking eBPF programs To allow programs to be loaded automatically at system launch time To simplify the packaging and loading of eBPF-based infrastructure software (i.e Kubernetes CNI plugins) How does it work? bpfd is built using Aya an eBPF library written in Rust. It offers two ways of interaction: bpfctl : a command line tool using GRPC It is expected that humans will use bpfctl whereas other applications on the system wishing to load programs using bpfd will use the GRPC. This allows for API bindings to be generated in any language supported by protocol buffers. We are initially targeting Go and Rust. In order to allow the attachment of multiple XDP programs to the same interface, we have implemented the libxdp multiprog protocol . Offering this in bpfd allows for XDP applications whose loader was not using libxdp to benefit from this. We are also hoping to find a way for applications linked with libxdp to use bpfd instead if it's in use in the system.","title":"Welcome to bpfd"},{"location":"#welcome-to-bpfd","text":"bpfd is a system daemon for managing eBPF programs. It currently a work in progress!","title":"Welcome to bpfd"},{"location":"#why-bpfd","text":"bpfd seeks to solve the following problems: To allow multiple XDP programs to share the same interface To give administrators control over who can load programs and to allow them to define rules for ordering of networking eBPF programs To allow programs to be loaded automatically at system launch time To simplify the packaging and loading of eBPF-based infrastructure software (i.e Kubernetes CNI plugins)","title":"Why bpfd?"},{"location":"#how-does-it-work","text":"bpfd is built using Aya an eBPF library written in Rust. It offers two ways of interaction: bpfctl : a command line tool using GRPC It is expected that humans will use bpfctl whereas other applications on the system wishing to load programs using bpfd will use the GRPC. This allows for API bindings to be generated in any language supported by protocol buffers. We are initially targeting Go and Rust. In order to allow the attachment of multiple XDP programs to the same interface, we have implemented the libxdp multiprog protocol . Offering this in bpfd allows for XDP applications whose loader was not using libxdp to benefit from this. We are also hoping to find a way for applications linked with libxdp to use bpfd instead if it's in use in the system.","title":"How does it work?"},{"location":"admin/","text":"Administration Guide This guide covers how to use bpfd for System Administrators","title":"Administration Guide"},{"location":"admin/#administration-guide","text":"This guide covers how to use bpfd for System Administrators","title":"Administration Guide"},{"location":"admin/configuration/","text":"Configuration bpfd bpfd expects a configuration file to be present at /etc/bpfd.toml . If no file is found, defaults are assumed. [ tls ] # REQUIRED ca_cert = \"/etc/bpfd/certs/ca/ca.pem\" cert = \"/etc/bpfd/certs/bpfd/bpfd.pem\" key = \"/etc/bpfd/certs/bpfd/bpfd.key\" [interfaces] [interface.eth0] xdp_mode = \"hw\" # Valid xdp modes are \"hw\", \"skb\" and \"drv\". Default: \"skb\". bpfctl bpfctl expects a configuration file to be present at /etc/bpfd.toml . If no file is found, defaults are assumed. [ tls ] # REQUIRED ca_cert = \"/etc/bpfd/certs/ca/ca.pem\" cert = \"/etc/bpfd/certs/bpfctl/bpfctl.pem\" key = \"/etc/bpfd/certs/bpfctl/bpfctl.key\"","title":"Configuration"},{"location":"admin/configuration/#configuration","text":"","title":"Configuration"},{"location":"admin/configuration/#bpfd","text":"bpfd expects a configuration file to be present at /etc/bpfd.toml . If no file is found, defaults are assumed. [ tls ] # REQUIRED ca_cert = \"/etc/bpfd/certs/ca/ca.pem\" cert = \"/etc/bpfd/certs/bpfd/bpfd.pem\" key = \"/etc/bpfd/certs/bpfd/bpfd.key\" [interfaces] [interface.eth0] xdp_mode = \"hw\" # Valid xdp modes are \"hw\", \"skb\" and \"drv\". Default: \"skb\".","title":"bpfd"},{"location":"admin/configuration/#bpfctl","text":"bpfctl expects a configuration file to be present at /etc/bpfd.toml . If no file is found, defaults are assumed. [ tls ] # REQUIRED ca_cert = \"/etc/bpfd/certs/ca/ca.pem\" cert = \"/etc/bpfd/certs/bpfctl/bpfctl.pem\" key = \"/etc/bpfd/certs/bpfctl/bpfctl.key\"","title":"bpfctl"},{"location":"admin/tutorial/","text":"Tutorial This tutorial will show you how to use bpfd. Prerequisites This tutorial uses examples from the xdp-tutorial . You will need to check out the git repository and compile the examples. Step 1: Start bpfd sudo bpfd& Step 2: Load your first program We will load the simple xdp-pass program, which permits all traffic, to the interface eth0. The section in the object file that contains the program is \"xdp\". Finally, we will use the priority of 100 - valid values are from 0 to 255. bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 100 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 92e3e14c-0400-4a20-be2d-f701af21873c bpfctl returns a unique identifier to the program that was loaded. This may be used to detach the program later. We can check the program was loaded using the following command: bpfctl list -i eth0 wlp2s0 xdp_mode: skb 0: 92e3e14c-0400-4a20-be2d-f701af21873c name: \"xdp\" priority: 100 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o From the output above you can see the program was loaded to slot 0 on our interface and will be executed first. Step 3: Loading more programs We will now load 2 more programs with different priorities to demonstrate how bpfd will ensure they are ordered correctly: bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 50 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 200 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 6af7c28f-6a7f-46ee-bc98-2d92ed261369 Using bpfctl list we can see that the programs are correctly ordered. The lowest priority program is executed first, while the highest is executed last bpfctl list -i eth0 eth0 xdp_mode: skb 0: 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 name: \"xdp\" priority: 50 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1: 92e3e14c-0400-4a20-be2d-f701af21873c name: \"xdp\" priority: 100 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 2: 6af7c28f-6a7f-46ee-bc98-2d92ed261369 name: \"xdp\" priority: 200 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o Step 4: Delete a program Let's remove the program at slot 1. bpfctl unload -i eth0 92e3e14c-0400-4a20-be2d-f701af21873c And we can verify that it has been removed and the other programs re-ordered: eth0 xdp_mode: skb 0: 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 name: \"xdp\" priority: 50 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1: 6af7c28f-6a7f-46ee-bc98-2d92ed261369 name: \"xdp\" priority: 200 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o","title":"Tutorial"},{"location":"admin/tutorial/#tutorial","text":"This tutorial will show you how to use bpfd.","title":"Tutorial"},{"location":"admin/tutorial/#prerequisites","text":"This tutorial uses examples from the xdp-tutorial . You will need to check out the git repository and compile the examples.","title":"Prerequisites"},{"location":"admin/tutorial/#step-1-start-bpfd","text":"sudo bpfd&","title":"Step 1: Start bpfd"},{"location":"admin/tutorial/#step-2-load-your-first-program","text":"We will load the simple xdp-pass program, which permits all traffic, to the interface eth0. The section in the object file that contains the program is \"xdp\". Finally, we will use the priority of 100 - valid values are from 0 to 255. bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 100 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 92e3e14c-0400-4a20-be2d-f701af21873c bpfctl returns a unique identifier to the program that was loaded. This may be used to detach the program later. We can check the program was loaded using the following command: bpfctl list -i eth0 wlp2s0 xdp_mode: skb 0: 92e3e14c-0400-4a20-be2d-f701af21873c name: \"xdp\" priority: 100 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o From the output above you can see the program was loaded to slot 0 on our interface and will be executed first.","title":"Step 2: Load your first program"},{"location":"admin/tutorial/#step-3-loading-more-programs","text":"We will now load 2 more programs with different priorities to demonstrate how bpfd will ensure they are ordered correctly: bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 50 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 bpfctl load -p xdp -i eth0 -s \"xdp\" --priority 200 /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 6af7c28f-6a7f-46ee-bc98-2d92ed261369 Using bpfctl list we can see that the programs are correctly ordered. The lowest priority program is executed first, while the highest is executed last bpfctl list -i eth0 eth0 xdp_mode: skb 0: 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 name: \"xdp\" priority: 50 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1: 92e3e14c-0400-4a20-be2d-f701af21873c name: \"xdp\" priority: 100 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 2: 6af7c28f-6a7f-46ee-bc98-2d92ed261369 name: \"xdp\" priority: 200 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o","title":"Step 3: Loading more programs"},{"location":"admin/tutorial/#step-4-delete-a-program","text":"Let's remove the program at slot 1. bpfctl unload -i eth0 92e3e14c-0400-4a20-be2d-f701af21873c And we can verify that it has been removed and the other programs re-ordered: eth0 xdp_mode: skb 0: 1ccc1376-60e8-4dc5-9079-6c32748fa1c4 name: \"xdp\" priority: 50 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o 1: 6af7c28f-6a7f-46ee-bc98-2d92ed261369 name: \"xdp\" priority: 200 path: /home/dave/dev/xdp-tutorial/basic01-xdp-pass/xdp_pass_kern.o","title":"Step 4: Delete a program"},{"location":"developer/","text":"Developer Guide This guide covers how to use bpfd for Developers","title":"Developer Guide"},{"location":"developer/#developer-guide","text":"This guide covers how to use bpfd for Developers","title":"Developer Guide"},{"location":"developer/go/","text":"Go An example application that uses the bpfd-go bindings can be found here","title":"Go"},{"location":"developer/go/#go","text":"An example application that uses the bpfd-go bindings can be found here","title":"Go"}]}